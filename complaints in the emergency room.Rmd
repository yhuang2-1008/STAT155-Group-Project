---
title: "Complaints About Emergency Room Doctors "
author: "Traci, Zixuan, and Jennifer"
output:
  html_document:
    df_print: paged
---

Feedback from Lisa:  

(@) Be sure to exclude your R code. I say how to do that in the project documentation on Moodle.

* Jennifer: we don't need to worry about this one because I already made the edits. 

(@) If you want to look at visits vs. complaints, you will need to use a scatterplot. The boxplot is not doing the right thing.

(@) Stay focused on your research question - the graphs should be relevant to that question as well. They are all nice graphs, but not all of them seem to be related to your main question. So, be sure to tie each of them back to the main question.

(@) It looks like you have some interesting models, but it would be helpful if you provided some reasoning as to why you chose to fit the ones you did. You also don't necessarily have to explain every single coefficient from every single model. Focus on the key takeaways from the model. 

\
\
\
\
\
\
\
\



![Emergency Room Doctors](https://www.rd.com/wp-content/uploads/2016/07/1_secrets_emergency_andresr-1024x683.jpg)

```{r setup, include=FALSE}
library(faraway)
library(tidyverse)
library(ggridges)
library(moderndive)
library(broom)
```

\
\
\
\
\
\
\
\
\
\
\
\

# Preliminary analysis 
Dataset has 44 doctors serveyed in 1998. Variables examined are *visits*, *complaints*, *residency*, *gender*, *revenue*, and *hours*. We are trying to determine whether visits, gender, revenue, and hours worked predict number of complaints received. 

\
\

# Research question 
Our main research question is whether gender is a major factor that affects the number of complaints received. 

\
\
\
\
\
\
\
\
\
\
\
\

## Gender vs residency
```{r, results='hide', warning=FALSE, message=FALSE, echo=FALSE}
ggplot(data=esdcomp)+
  geom_bar(mapping = aes(x=gender, fill=residency))
```
* More male doctors are in residency training, however, there is more men in our data.

\
\
\
\
\
\
\

## Number of Complaints Vs. Gender & Number of Visits
```{r, results='hide', warning=FALSE, message=FALSE, echo=FALSE}
ggplot(data=esdcomp)+
  geom_boxplot(aes(x=visits, y=complaints, color=gender))
```

* Women have less visists than men 
* Median number of complaints are similar for both genders 
* Upper quartile for complaints for men is larger than that of women  -- there is more variation in complaints for men, data is skewed right, higher maximum 
* Possible reasons:
  + more visits = more patients that could complain = working more hours (tired and slack -> get complains) 
  + less female doctors 

\
\
\
\
\
\
\

## Number of Complaints Vs. Hours Worked & Gender

```{r, results='hide', warning=FALSE, message=FALSE, echo=FALSE}
ggplot(data=esdcomp)+
  geom_boxplot(aes(x=visits, y=hours, color=gender))
```

* Women have less visits but worked more hours than men, slightly more variation 
* Median for both genders are very similar 
* Minimum for men's working hour is higher than that of women's 
* Men work more hours to begin with thus they have more complaints

\
\
\
\
\
\

## Gender vs. Revenue

Density plot of *gender* vs *revenue*

```{r, results='hide', warning=FALSE, message=FALSE, echo=FALSE}
ggplot(data=esdcomp)+
  geom_density_ridges(aes(x=revenue, y=gender, fill=gender))
```

* There is a more even distribution of revenue for male doctors than for female doctors 
* Men make more in general (min and max)
* Women's median income is 250, men is closer to 260/270. 

\
\
\
\
\
\

Boxplot of *gender* vs *revenue*

```{r, results='hide', warning=FALSE, message=FALSE, echo=FALSE}
ggplot(data=esdcomp)+
  geom_boxplot(aes(x=gender, y=revenue))
```

* Females make less revenue 
* More variation in male revenue 
* Maximum for male is a lot higher than that of women 

\
\
\
\
\
\
\

# Modeling predcition

\

### New dataset 
Since the data of hours and visits is too large to compare with the data for number of complaints we created a new dataset by dividing visits and hours by one hundred.

```{r, results='hide', warning=FALSE, message=FALSE, echo=FALSE}
esdcomp_final <- esdcomp %>% 
  mutate(visits_hundred = visits/100, hours_hundred = hours/100) 
```

\
\
\
\
\
\
\

#### Model for Number of Complaints Predicted by *Visits* * *Hours*
```{r, warning=FALSE, message=FALSE, echo=FALSE}
lm_comp_visit_hour <- lm(complaints ~ visits_hundred *hours_hundred, data = esdcomp_final)

get_regression_table(lm_comp_visit_hour)
```

a) Intercept:
Average number of complaints is 6.013, not taking account the gender of the doctor.

b) Visits:
For every addition of 100 visit on average there is a a decrease of 0.225 in number of complaints by holding hours constant. 

c) Hours:
For every addition of 100 more hour worked there is a decrease of 0.652 to the number of complaints by holding visits constant.

d) Visits:Hours:
When hours worked and number of visits are both present there is an increase of 0.034 for every 1 unit increase in both variables.

e) Intention
Without taking gender into account, will visits and hours affect the number of complaints the doctors get.

\
\
\
\
\
\
\

#### Model for Number of Complaints Predicted by *Visits* + *Hours* + *Gender* 

Complaints Predicted by *visits*, *hours*, *gender*

```{r, warning=FALSE, message=FALSE, echo=FALSE}
lm_com_vis_hou_gen <- lm(complaints ~ visits_hundred + hours_hundred + gender, data= esdcomp_final)

get_regression_table(lm_com_vis_hou_gen)
```

a) Intercept:
Female doctors on average have a decrease of 2.956 in the number of complaints. 

b) Visits:
For every increase of 100 visit there is an increase of 0.262 in the number of complaints. 

c) Hours:
For every addition of 100 hour worked there is an decrease of 0.014 in the number of complaints.

d) Male Gender:
Male doctors on average have a higher number of complaints of 0.355 when compared to female doctors. 

e) Intention:
In comparison to the previous one, this shows how gender affects the number complaints.

\
\
\
\
\
\
\

#### Model for Number of Complaints Predicted by *Gender* + *Revenue*  

Complaints Predicted with *gender* & *revenue*
```{r, warning=FALSE, message=FALSE, echo=FALSE}
lm_comp_gen_rev <- lm(complaints ~ gender + revenue, data=esdcomp_final)

get_regression_table(lm_comp_gen_rev)
```

a) Intercept:
A female doctor has a decrease of 0.292 in the number of complaints.

b) GenderMale:
Male doctors on average have an increase of 0.896 in the number of complaints when compared to female doctors.

c) Revenue:
For every 1 unit increase in revenue increases the number of complaints by 0.011.

d) Intention:
To observe how much the doctors earned, taking gender into consideration to predict number of complants. 

\
\
\
\
\
\
\
\
\
\
\

#### $R^2$ for all models 

```{r, warning=FALSE, message=FALSE, echo=FALSE}
#Model 1
get_regression_summaries(lm_comp_visit_hour)

#Model 2
get_regression_summaries(lm_com_vis_hou_gen)

#Model 3
get_regression_summaries(lm_comp_gen_rev)
```

a) 41% of the variability in number of complaints is explained by the variability in number of hours worked and number of visits.

b) 35% of the variability in number of complaints is explained by the variability in number of hours worked, number of visits and gender.

c) 4.6% of the variability in number of complaints is explained by the variability in number of revenue earned and gender.

\
\
\
\
\
\
\

# Conclusion

* Preliminary graphs showed us a disparity between revenue and number of visits between doctors that could possibly explain the differences in the number of complaints recieved. 

* According to our model, gender plays a role in predicting number of complaints, revenued eared does not affect much. The interaction effect number of hours worked and number of visits plays a more significant role in predicting the number of complaints.

\
\
\
\
\
\
\
\
\
\
\
\
\
\


# Variables that we wish we had 

* One variable that we would have liked to have was the number of years that each doctor has worked to see how experience affects the number of complaints recieved. 

* Also, knowing the method that the complaint was given. For example, whether complaints were given directly to the doctors or an indirect form. 

* It would also be interesting to have a variable of the success and failures of surgeries.

\
\
\
\
\
\
\
\
\
\
\
\
\
\
\


# Implications of dataset and prediction

* Many people have a distrust of the healthcare system and one way this distrust is shown is through complaints. How often and how many complaints are recieved by a doctor is thought to be based on the quality of health service provided, which can be affected by the number of visits and number of hours worked. Gender also plays a role in this phenomenon. Are you more likely to complain to a male doctor or a female doctor? Our society has shaped women's impression into something weaker and more approachable than that of men.

* Sometimes number of visits and number of hours worked does not have a linear relationship (i.e. visits increase as hours increase). Thus the complaints that doctors receive may not be representative of their quality of service.

* In our age, we rely on "Yelp" reviews so much and doctors often worry about their own reviews. Thus having lower number of complaints becomes a competition in the industry.

\
\
\
\
\
\
\
\
\
\
\
\
