---
title: "Complaints about emergency room doctors "
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
library(faraway)
library(tidyverse)
library(ggridges)
library(moderndive)
```


# Preliminary analysis 
Dataset has 44 doctors serveyed in 1998. Variables examined are *visits*, *complaints*, *residency*, *gender*, *revenue*, and *hours*. We are trying to determine whether visits, gender, revenue, and hours worked predict number of complaints received. 


#Number of Complaints Vs. Gender & Number of Visits
```{r}
ggplot(data=esdcomp)+
  geom_boxplot(aes(x=visits, y=complaints, color=gender))
```

* Women have less visists than men 
* Median number of complaints are similar for both gender 
* Upper quartile for complaints for men is larger than that of women  -- there is more variation in complaints for men, data is skewed right, higher maximum 
* Possible reasons:
  + more visits = more patients that could complain = working more hours (tired and slack -> get complains) 
  + less female doctors 

\
#Gender Distribution
```{r}
ggplot(data=esdcomp)+
  geom_bar(aes(x=gender))
```

* Less female doctors 

\
#Gender & Revenue
```{r}
ggplot(data=esdcomp)+
  geom_boxplot(aes(x=gender, y=revenue))
```

* Females make less revenue 
* More variation in male revenue 
* Maximum for male is a lot higher than that of women 

\
#Number of Complaints Vs. Hours Worked & Gender

```{r}
ggplot(data=esdcomp)+
  geom_boxplot(aes(x=visits, y=hours, color=gender))
```

* Women have less visits but worked more hours than men 
* Median for both genders are very similar 
* Minimum for men's working hour is higher than that of women's 

\

#Number of Complaints vs Hours Worked & Gender

```{r}
ggplot(data=esdcomp)+
  geom_boxplot(aes(x=complaints, y=hours, color=gender))
```

* Women get less complaints but work more hours, slightly more variation 
* Men work more hours to begin with thus have more complaints

\

#Gender vs. Revenue

```{r,  warning=FALSE, message=FALSE}
ggplot(data=esdcomp)+
  geom_density_ridges(aes(x=revenue, y=gender, fill=gender))
```

* There is a more even distribution of revenue for male doctors than for female doctors 
* Men make more in general (min and max)
* Women's median income is 250, men is closer to 260/270. 

\
\
\
\
\

# STEP FORWARD
See how the results come out then decided if we do a interaction effect 

(@) lm model: complaints ~ visits + hours 

# Model for Number of Complaints Predicted by *Visits* & *Hours*
```{r}
lm_comp_visit_hour <- lm(complaints ~ visits + hours, data = esdcomp)

get_regression_table(lm_comp_visit_hour)
```

##Intercept
Average number of complaints is -2.714.

##Visits
For every addition of 1 visit on average there is a an increase of 0.003 in number of complaints. 

##Hours
For every addition of 1 more hour worked there is an increase of 0 to the number of complaints.


(@) lm model: complaints ~ visits + hours + gender 

#Complaints Predicted by *visits*, *hours*, *gender*

```{r}
lm_com_vis_hou_gen <- lm(complaints ~ visits + hours + gender, data= esdcomp)

get_regression_table(lm_com_vis_hou_gen)
```

##Intercept
Female doctors on average have a decrease of 2.956 in the number of complaints. 

##Visits
For every increase of 1 visit there is an increase of 0.003 in the number of complaints. 

##Hours
For every addition of 1 hour worked there is an increase of 0 in the number of complaints.

##Male Gender
Male doctors on average have a higher number of complaints of 0.355 when compared to female doctors. 


(@) lm model: complaints ~ gender + revenue 

#Complaints Predicted with *gender* & *revenue*
```{r}
lm_comp_gen_rev <- lm(complaints ~ gender + revenue, data=esdcomp)

get_regression_table(lm_comp_gen_rev)
```
##Intercept
A female doctor has a decrease of 0.292 in the number of complaints.

##GenderMale
Male doctors on average have an increase of 0.896 in the number of complaints when compared to female doctors.

##Revenue
For every 1 unit increase in revenue increases the number of complaints by 0.011.


(@) find R^2 for all models and explain in terms of the dataset 

#R^2 Values For Models
```{r}
#Model 1
get_regression_summaries(lm_comp_visit_hour)

#Model 2
get_regression_summaries(lm_com_vis_hou_gen)

#Model 3
get_regression_summaries(lm_comp_gen_rev)
```
(@) summarize results 

*Preliminary graphs showed us a disparity between revenue and number of visits between doctors that could possibly explain the differences in the number of complaints recieved. 

*However, with the models created we saw that number of hours worked didn't play a signifanct role in explaining number of complaints. 

(@) talk about variables that we wished we had 

One variable that we would have liked to have was the number of years that each doctor has worked to see how experience affects the number of complaints recieved. 

Also, knowing the method that the complaint was given whether it was directly to the doctors or an indirect form. 


(@) implications of the dataset and our prediction 

* Many people have a distrust of the healthcare system and one way this distrust is shown is through complaints. How often and how many complaints are recieved by a doctor is thought to be based on the quality of health service provided, which can be affected by the number of visits and number of hours worked. 



